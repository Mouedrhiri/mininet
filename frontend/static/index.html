<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MiniNet - Réseau Social</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <!-- Navigation -->
  <nav class="navbar" id="navbar">
    <div class="navbar-container">
      <a href="#" class="logo" onclick="showPage('feed'); return false;">MiniNet</a>
      <div class="navbar-menu" id="navbarMenu">
        <a href="#" class="nav-link" onclick="showPage('feed'); return false;">Fil</a>
        <a href="#" class="nav-link" onclick="showPage('messages'); return false;">Messages</a>
        <a href="#" class="nav-link" onclick="showPage('profile'); return false;">Profil</a>
        <a href="#" class="nav-link" onclick="showNotifications(); return false;">Notifications <span class="badge" id="notifBadge" style="display:none;">0</span></a>
        <button class="btn-logout" onclick="logout()">Déconnexion</button>
      </div>
    </div>
  </nav>

  <div class="main-container">
    <!-- Auth Page -->
    <div id="authPage" class="page">
      <div class="auth-container">
        <h1>MiniNet</h1>
        <p class="tagline">Partagez vos pensées avec vos amis</p>
        <div class="tabs">
          <button class="tab-btn active" onclick="switchAuthTab('login')">Connexion</button>
          <button class="tab-btn" onclick="switchAuthTab('register')">Inscription</button>
        </div>
        <form id="loginForm" class="auth-form" onsubmit="handleLogin(event)">
          <input type="text" id="loginUsername" placeholder="Nom d'utilisateur" required>
          <input type="password" id="loginPassword" placeholder="Mot de passe" required>
          <button type="submit" class="btn btn-primary">Se connecter</button>
          <p id="loginError" class="error-msg"></p>
        </form>
        <form id="registerForm" class="auth-form hidden" onsubmit="handleRegister(event)">
          <input type="text" id="registerUsername" placeholder="Nom d'utilisateur" required>
          <input type="password" id="registerPassword" placeholder="Mot de passe" required>
          <input type="password" id="registerPassword2" placeholder="Confirmer" required>
          <button type="submit" class="btn btn-primary">S'inscrire</button>
          <p id="registerError" class="error-msg"></p>
        </form>
      </div>
    </div>

    <!-- Feed Page -->
    <div id="feedPage" class="page hidden">
      <div class="feed-container">
        <div class="post-creator">
          <h3>Créer un post</h3>
          <form id="postForm" onsubmit="handleCreatePost(event)">
            <textarea id="postText" placeholder="Qu'y a-t-il de nouveau ?" required></textarea>
            <div class="post-options">
              <select id="postType" onchange="updatePostTypeOptions()">
                <option value="text">Texte uniquement</option>
                <option value="image">Avec image</option>
                <option value="link">Avec lien</option>
              </select>
              <input type="text" id="postUrl" placeholder="https://..." style="display:none;">
              <input type="file" id="postImage" accept="image/*" style="display:none;">
            </div>
            <button type="submit" class="btn btn-primary">Publier</button>
          </form>
        </div>
        <div id="feedPosts" class="feed"></div>
      </div>
      <aside class="sidebar">
        <div class="friends-widget">
          <h3>Mes amis</h3>
          <div id="friendsList" class="friends-list"></div>
          <button class="btn btn-secondary" onclick="showAddFriendModal()">+ Ajouter un ami</button>
        </div>
      </aside>
    </div>

    <!-- Profile Page -->
    <div id="profilePage" class="page hidden">
      <div class="profile-container">
        <div class="profile-header">
          <div class="profile-avatar"></div>
          <div class="profile-info">
            <h2 id="profileUsername"></h2>
            <p id="profileStats"></p>
          </div>
        </div>
        <div class="profile-section">
          <h3>Mes posts</h3>
          <div id="userPosts" class="feed"></div>
        </div>
      </div>
    </div>

    <!-- Messages Page -->
    <div id="messagesPage" class="page hidden">
      <div class="messages-container">
        <div class="conversations-list">
          <h3>Conversations</h3>
          <div id="conversationsList" class="conversations"></div>
        </div>
        <div class="message-view">
          <div id="messageThread" class="messages-thread" style="display:none;"></div>
          <div id="noConversation" class="no-conversation">Sélectionnez une conversation</div>
          <form id="messageForm" class="message-input" style="display:none;" onsubmit="handleSendMessage(event)">
            <input type="text" id="messageText" placeholder="Votre message..." required>
            <button type="submit" class="btn btn-primary">Envoyer</button>
          </form>
        </div>
      </div>
    </div>

    <!-- Notifications Page -->
    <div id="notificationsPage" class="page hidden">
      <div class="notifications-container">
        <h2>Notifications</h2>
        <div id="notificationsList" class="notifications-list"></div>
        <button class="btn btn-secondary" onclick="markAllNotificationsRead()">Marquer tout comme lu</button>
      </div>
    </div>
  </div>

  <!-- Modals -->
  <div id="addFriendModal" class="modal hidden">
    <div class="modal-content">
      <span class="close" onclick="closeAddFriendModal()">&times;</span>
      <h3>Ajouter un ami</h3>
      <form onsubmit="handleAddFriend(event)">
        <input type="text" id="addFriendUsername" placeholder="Nom d'utilisateur" required>
        <button type="submit" class="btn btn-primary">Ajouter</button>
        <p id="addFriendError" class="error-msg"></p>
      </form>
    </div>
  </div>

  <div id="viewProfileModal" class="modal hidden">
    <div class="modal-content">
      <span class="close" onclick="closeViewProfileModal()">&times;</span>
      <div id="viewProfileContent"></div>
    </div>
  </div>

  <script src="js/api.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
